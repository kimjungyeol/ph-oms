<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="sample/layouts/default-layout">
<th:block layout:fragment="content">
    <div class="container">
        <h2>Board - Register - File</h2>
        <div data-trigger="form">
            <div class="mb-3">
                <label class="form-label fw-bold">Title.</label>
                <input type="text" class="form-control" id="title" name="title" maxlength="25" >
            </div>
            <div class="mb-3">
                <label class="form-label fw-bold">Contents.</label>
                <textarea class="form-control" id="contents" name="contents" rows="5" maxlength="1000"></textarea>
            </div>
        </div>
        <div data-trigger="form">
            <div class="mb-3 row">
                <div class="col">
                    <label class="form-label fw-bold">Use.</label>
                    <div>
                        <input class="form-check-input" type="radio" name="useYn" id="useYn1" value="Y">
                        <label class="form-check-label" for="useYn1">사용</label>
                        <input class="form-check-input" type="radio" name="useYn" id="useYn2" value="N">
                        <label class="form-check-label" for="useYn2">미사용</label>
                    </div>
                </div>
                <div class="col">
                    <label class="form-label fw-bold">Use-selectbox.</label>
                    <div>
                        <select id="use_select" name="use_select" style="width: 100px;">
                            <option value="">--Select-</option>
                            <option value="Y">사용</option>
                            <option value="N">미사용</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mb-3">
        	<label class="form-label fw-bold">파일 첨부 영역1</label>
	        <div data-file="user"></div>
        </div>
        
        <br>
        <br>
        
        <div class="mb-3">
        	<label class="form-label fw-bold">파일 첨부 영역2</label>
	        <div data-file="company"></div>
        </div>
        
        <div data-trigger="button">
            <div class="float-end">
                <button type="button" class="btn btn-danger" id="saveBtn">Save</button>
            </div>
        </div>
    </div>
    <script th:inline="javascript">
        'use strict';
        // 1.page init area.
        ;(function(co, fn) {
            co.initParams = {
            	title: 'file title test.',
            	contents: 'file contents test.',
            	useYn: 'Y',
            	use_select: 'N',
            };
            
            co.uriMap = {
                search : '/sample/board/register/search',
                save   : '/sample/board/register/saveForm',
            }
            
            co.moveMap = {
            }
            
            co.fileId = {
            	user: '',   //<div data-file="user"></div>
            	company: '' //<div data-file="company"></div> 
            }
            
        })(wg.c, wg.f);
        
        // 2.function area.
        ;(function(co, fn, trigger) {
            fn.search = function() {
            	let opt = {
            		uri : co.uriMap.search,
            		params : co.initParams
            	}
            	fn.api.search(opt, function(res) {
            		if (res.result) {
            			// set data value on based searched data.
            			fn.form.setData(res.data);
            			
            			//test용 fileId.
            			res.data.userFileId = 'c221f738-73e8-44d4-9c8d-3fd8c3b2f02e';
            			res.data.companyFileId = 'de5990d6-dbbc-4e63-bdc3-31b3b77fa4b5';
            			
            			//파일 리스트 조회.
            			co.fileId.user = res.data.userFileId,         
            			co.fileId.company = res.data.companyFileId    
            			
            			fn.file.load(co.fileId);
            		}
            	});
            }
            fn.save = function() {
            	let opt = {
               		uri : co.uriMap.save,
               		params : { 
               			aa: {bb : 'bb'},
               		}
               	}
            	fn.api.saveForm(opt, function() {
                    console.log('save callback fnc!!');
                });
            }
            
        })(wg.c, wg.f, wg.t);
        
        // 3.event area.
        ;(function(co, fn, trigger) {
            fn.event = function() {
                //save.
                $(trigger.button.saveBtn).click(function() {
                    fn.save();
                });
                //move page.
                $(trigger.button.prevBtn).click(function() {
                    fn.move.page(co.moveMap.boardList);
                });
            }
        })(wg.c, wg.f, wg.t);
    </script>
    <script th:inline="javascript">
        'use strict';
        $(document).ready(async() => {
            const fn = wg.f;
            
            await fn.file.render();
            await fn.event();
            await fn.search();
        });
    </script>
</th:block>
</html>
